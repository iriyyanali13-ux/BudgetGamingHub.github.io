<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI-Chat | Gaming Budget Hub</title>
    <style>
        :root { --primary-neon: #00ffcc; --bg-deep: #0b0e14; --card-bg: #161b22; }
        body { background-color: var(--bg-deep); color: #e6edf3; font-family: 'Segoe UI', sans-serif; margin: 0; display: flex; flex-direction: column; min-height: 100vh; }
        .header { background: rgba(13, 17, 23, 0.95); border-bottom: 2px solid var(--primary-neon); padding: 1rem 5%; display: flex; justify-content: space-between; align-items: center; }
        .logo { font-size: 1.5rem; font-weight: 800; color: var(--primary-neon); text-transform: uppercase; }
        .container { max-width: 800px; margin: 40px auto; padding: 0 20px; flex: 1; display: flex; flex-direction: column; }
        .chat-card { background: var(--card-bg); border: 1px solid #30363d; border-radius: 12px; height: 500px; display: flex; flex-direction: column; overflow: hidden; }
        #chat-history { flex: 1; overflow-y: auto; padding: 20px; display: flex; flex-direction: column; gap: 15px; }
        .message { max-width: 80%; padding: 12px 18px; border-radius: 18px; font-size: 15px; }
        .user-message { align-self: flex-end; background-color: var(--primary-neon); color: #0b0e14; }
        .ai-message { align-self: flex-start; background-color: #30363d; color: #e6edf3; }
        .input-area { padding: 20px; border-top: 1px solid #30363d; display: flex; gap: 10px; }
        input { flex: 1; padding: 12px; background: #0d1117; border: 1px solid #30363d; border-radius: 25px; color: #fff; outline: none; }
        button { background: var(--primary-neon); color: #0b0e14; border: none; padding: 10px 25px; border-radius: 25px; cursor: pointer; font-weight: bold; }
    </style>
</head>
<body>

<header class="header">
    <div class="logo">Gaming Budget Hub</div>
</header>

<main class="container">
    <div class="chat-card">
        <div id="chat-history">
            <div class="message ai-message">Welcome back! If you still see an error, please make sure this file is uploaded to GitHub and not just on your desktop.</div>
        </div>
        <div class="input-area">
            <input type="text" id="user-input" placeholder="Ask about PC parts...">
            <button id="send-btn">Send</button>
        </div>
    </div>
</main>

<script type="module">
    import { GoogleGenerativeAI } from "https://esm.run/@google/generative-ai";

    const API_KEY = "AIzaSyBS3ijU2RIIDQFnCfDaoV_EUxPIay3mdIM"; 
    const genAI = new GoogleGenerativeAI(API_KEY);
    const model = genAI.getGenerativeModel({ model: "gemini-1.5-flash" });

    const history = document.getElementById('chat-history');
    const input = document.getElementById('user-input');
    const btn = document.getElementById('send-btn');

    async function handleChat() {
        const text = input.value.trim();
        if (!text) return;

        // Add User Message
        const uMsg = document.createElement('div');
        uMsg.className = 'message user-message';
        uMsg.textContent = text;
        history.appendChild(uMsg);
        input.value = '';

        try {
            const result = await model.generateContent(text);
            const response = await result.response;
            
            // Add AI Message
            const aMsg = document.createElement('div');
            aMsg.className = 'message ai-message';
            aMsg.textContent = response.text();
            history.appendChild(aMsg);
        } catch (error) {
            const eMsg = document.createElement('div');
            eMsg.className = 'message ai-message';
            eMsg.textContent = "Error: Connection blocked. Move this file to GitHub Pages or check if the API is 'Enabled' in Google Cloud.";
            history.appendChild(eMsg);
            console.error(error);
        }
        history.scrollTop = history.scrollHeight;
    }

    btn.onclick = handleChat;
    input.onkeypress = (e) => { if(e.key === 'Enter') handleChat(); };
</script>

</body>
</html>